[
{"_type":{"location":"server","name":"chart"},"owner":4,"key":1039,"permission":{"list":[{"perm":"fork","type":"global","target":null,"username":"and anonymous user","displayname":"Everyone"}],"switch":"publish"},"name":"Sankey Chord","theme":null,"parent":null,"description":"hybrid sankey chart with chord diagram","basetype":["6","12"],"visualencoding":["5","6"],"category":["1","4","5"],"tags":["chord","sankey","relation","relationship"],"likes":null,"searchable":true,"doc":{"name":"document","size":0,"type":"html","lines":1,"content":""},"style":{"name":"stylesheet","size":0,"type":"css","lines":1,"content":""},"code":{"name":"code","size":11917,"type":"javascript","lines":297,"content":"var module = {};\nmodule.exports = plotdb.chart.create({\n  sample: function() {\n    var list = d3.range(49);\n    var continents = [\"Asia\",\"North America\",\"South America\",\"Africa\",\"Europe\",\"Australia\",\"Oceania\"];\n    return {\n      src: [{name: \"Continent\", data: list.map(function(d,i) { return continents[i % continents.length]; })}],\n      des: [{name: \"Continent\", data: list.map(function(d,i) { return continents[parseInt(i / continents.length)]; })}],\n      size: [{name: \"Value\", data: list.map(function(d,i) { return Math.round(100 * Math.random()); })}]\n    };\n  },\n  dimension: {\n    src: { type: [], require: true, desc: \"name of source node\" },\n    des: { type: [], require: true, desc: \"name of destination node\" },\n    size: { type: [plotdb.Number], require: true, desc: \"flow size\" }\n  },\n  config: {\n    fontSize: {},\n    margin: {},\n    padding: {},\n    palette: {},\n    otherLimit: {rebindOnChange: true},\n    otherLabel: {rebindOnChange: true},\n    thick: { name: \"Thickness\", type: [plotdb.Number], default: 20 },\n  },\n  init: function() {\n    var that = this, it;\n    this.svg = d3.select(this.root).append(\"svg\");\n    this.srcGroup = this.svg.append(\"g\").attr({class: \"src arc\"});\n    this.desGroup = this.svg.append(\"g\").attr({class: \"des arc\"});\n    this.chordGroup = this.svg.append(\"g\").attr({class: \"chord connect arc\"});\n    setTimeout(function() {\n      that.data.map(function(d,i) {\n        d.size = Math.pow(d.size/10, 2) * 10;\n        that.parse();\n        that.resize();\n        that.bind();\n        that.render();\n      });\n    }, 1000);\n    /*this.popupArc = plotd3.html.popup(this.root).on(\"mousemove\", function(d,i,popup) {\n      popup.select(\".title\").text(d.key);\n      popup.select(\".value\").text(d.sum);\n    });\n    this.popupChord = plotd3.html.popup(this.root).on(\"mousemove\", function(d,i,popup) {\n      popup.select(\".value:nth-of-type(1)\").text(d.src);\n      popup.select(\".value:nth-of-type(2)\").text(\"↓ ( \" + d.size +\" )\");\n      popup.select(\".value:nth-of-type(3)\").text(d.des);\n    });\n    this.popupChord.getPopupNode().call(function(d,i) {\n      this.select(\".title\").remove();\n      this.append(\"div\").attr({class: \"value\"});\n      this.append(\"div\").attr({class: \"value\"});\n    });*/\n  },\n  parse: function() {\n    var that = this;\n    var dessize = {}, srcsize = {};\n    if(!this.dimension.src.fields.length) this.data.map(function(d,i) { d.src = \"?\"; });\n    if(!this.dimension.des.fields.length) this.data.map(function(d,i) { d.des = \"?\"; });\n    if(!this.dimension.size.fields.length) this.data.map(function(d,i) { d.size = 1; });\n    this.data = this.data.filter(function(it) { return it.src && it.des; });\n    this.data.forEach(function(d,i) {\n      dessize[d.des] = (dessize[d.des] || 0) + d.size;\n      srcsize[d.src] = (srcsize[d.src] || 0) + d.size;\n    });\n    this.data.forEach(function(d,i) {\n      if(dessize[d.des] < that.config.otherLimit) d.des = that.config.otherLabel;\n      if(srcsize[d.src] < that.config.otherLimit) d.src = that.config.otherLabel;\n    });\n    dessize = {}, srcsize = {};\n    this.data.forEach(function(d,i) {\n      dessize[d.des] = (dessize[d.des] || 0) + d.size;\n      srcsize[d.src] = (srcsize[d.src] || 0) + d.size;\n    });\n    var dsmap = {};\n    var parsed = [];\n    this.data.forEach(function(d,i) {\n      var name = \"[\" + d.src +\"][\" + d.des + \"]\";\n      if(!dsmap[name]) {\n        dsmap[name] = {src: d.src, des: d.des, size: 0};\n        parsed.push(dsmap[name]);\n      }\n      dsmap[name].size += d.size;\n    });\n    this.data = parsed;\n    this.nameLen = d3.max(this.data.map(function(it) { return [it.src, it.des]; })\n      .reduce(function(a,b) { return a.concat(b); }, [])\n      .map(function(it) { return (it || \"\").length; }));\n    var mapper = function(key) {\n      var ret = d3.nest().key(function(it) { return it[key]; }).entries(that.data).map(function(it) {\n        it.sum = it.values.reduce(function(a,b) { return a + b.size; }, 0);\n        return it;\n      });\n      var total = ret.reduce(function(a,b) { return a + b.sum; }, 0);\n      var offset = 0;\n      ret.sort(function(a,b) { return b.sum - a.sum; });\n      for(var i = 0; i < ret.length; i++) {\n        it = ret[i];\n        it.percent = it.sum / total;\n        it.offset = offset;\n        it._offset = 0;\n        offset += it.percent;\n        it.side = key;\n      }\n      return ret;\n    };\n    this.srcmap = mapper(\"src\");\n    this.desmap = mapper(\"des\");\n    this.data.sort(function(a,b) {\n      var ret = dessize[b.des] - dessize[a.des];\n      if(ret!=0) return ret;\n      return srcsize[b.src] - srcsize[a.src];\n    });\n    for(var i = 0, src, des; i < this.data.length; i++) {\n      it = this.data[i];\n      src = this.srcmap.filter(function(v) { return v.key == it.src; })[0];\n      des = this.desmap.filter(function(v) { return v.key == it.des; })[0];\n      it.coord = {\n        src: {node: src, offset: src._offset, percent: it.size / src.sum },\n        des: {node: des, offset: des._offset, percent: it.size / des.sum }\n      };\n      src._offset += (it.size / src.sum);\n      des._offset += (it.size / des.sum);\n    }\n  },\n  bind: function() {\n    var that = this,sel,n1,n2;\n    sel = this.srcGroup.selectAll(\"path.arc.src\").data(this.srcmap);\n    sel.exit().remove();\n    n1 = sel.enter().append(\"path\").attr({class: \"arc src\"});\n    sel = this.desGroup.selectAll(\"path.arc.des\").data(this.desmap);\n    sel.exit().remove();\n    n2 = sel.enter().append(\"path\").attr({class: \"arc des\"});\n    sel = this.chordGroup.selectAll(\"path.chord\").data(this.data);\n    sel.exit().remove();\n    sel.enter().append(\"path\").attr({class: \"chord\"});\n    sel = this.svg.selectAll(\"text.label.src\").data(this.srcmap);\n    sel.exit().remove();\n    sel.enter().append(\"text\").attr({class: \"label src\"});\n    sel = this.svg.selectAll(\"text.label.des\").data(this.desmap);\n    sel.exit().remove();\n    sel.enter().append(\"text\").attr({class: \"label des\"});\n    //this.popupChord.nodes(this.svg.selectAll(\"path.chord\"));\n    //this.popupArc.nodes(n1).nodes(n2);\n    this.svg.selectAll(\"path.chord\").on(\"mouseover\", function(d,i) {\n      if(that.handle) {\n        clearTimeout(that.handle);\n        that.handle = null;\n      }\n      that.target = {src: d.src, side: null, des: d.des};\n      that.render();\n    }).on(\"mouseout\", function(d,i) {\n      that.handle = setTimeout(function() {\n        that.target = null; \n        that.render();\n      }, 1000);\n    });\n    this.svg.selectAll(\"path.arc\").on(\"mouseover\", function(d,i) {\n      if(that.handle) {\n        clearTimeout(that.handle);\n        that.handle = null;\n      }\n      that.target = {src: d.src || d.key, side: d.side, des: d.des || d.key};\n      that.render();\n    }).on(\"mouseout\", function(d,i) {\n      that.handle = setTimeout(function() {\n        that.target = null; \n        that.render();\n      }, 1000);\n    });\n  },\n  resize: function() {\n    var that = this;\n    var box = this.root.getBoundingClientRect();\n    var width = this.width = box.width;\n    var height = this.height = box.height;\n    var mw = width - this.config.fontSize * ( this.nameLen + 5);\n    var mh = height - this.config.fontSize * 2;\n    var size = this.size = (mw > mh ? mh : mw ) / 2\n    this.svg.attr({\n      width: width + \"px\", height: height + \"px\",\n      viewBox: [0,0,width,height].join(\" \"),\n      preserveAspectRatio: \"xMidYMid\"\n    });\n    //this.popupChord.fontSize(this.config.fontSize);\n    //this.popupArc.fontSize(this.config.fontSize);\n    this.thick = this.config.thick * ( this.width < 640 ? 0.5 : 1);\n    this.arc = d3.svg.arc().innerRadius(size - this.thick).outerRadius(size);\n    this.srcAscale = d3.scale.linear().domain([0,1]).range([-Math.PI/6,-Math.PI*5/6]);\n    this.desAscale = d3.scale.linear().domain([0,1]).range([Math.PI/6,Math.PI*5/6]);\n    this.color = d3.scale.ordinal().range(that.config.palette.colors.map(function(it) { return it.hex; }));\n  },\n  render: function() {\n    var that = this,sel;\n    sel = this.svg.selectAll(\"text.label\");\n    if(this.inited) sel = sel.transition(\"morph\").duration(500);\n    sel.attr({\n      transform: function(d,i) {\n        var scale = (d3.select(this).classed(\"src\") ? that.srcAscale : that.desAscale);\n        var a = ( scale(d.offset) + scale(d.offset + d.percent)) / 2;\n        var x = Math.sin(a) * (that.size + that.config.fontSize);\n        var y = -Math.cos(a) * (that.size + that.config.fontSize * 1.5);\n        return [\n          \"translate(\",\n          x + that.width / 2,\n          y + that.height / 2,\n          \")\"\n        ].join(\" \");\n      },\n      \"text-anchor\": function(d,i) {\n        return d3.select(this).classed(\"src\") ? \"end\" : \"start\";\n      },\n      \"dominant-baseline\": \"central\",\n      dx: function(d,i) {\n        return that.config.fontSize * (d3.select(this).classed(\"src\") ? -0 : 0);\n      },\n      \"font-size\": that.config.fontSize\n    }).text(function(d,i) { return d.key; });\n    this.svg.selectAll(\"g.arc\").attr({\n      transform: \"translate(\" + (that.width /2) + \",\" + (that.height / 2) + \")\"\n    });\n    sel = this.svg.selectAll(\"path.arc\");\n    if(this.inited) sel = sel.transition(\"morph\").duration(500);\n    sel.attr({\n      d: function(d,i) {\n        scale = (d3.select(this).classed(\"src\") ? that.srcAscale : that.desAscale);\n        return that.arc.startAngle(scale(d.offset)).endAngle(scale(d.offset + d.percent))();\n      },\n      fill: function(d,i) {\n        return that.color(d.key);\n      },\n      stroke: \"#fff\",\n      \"stroke-width\": 1\n    });\n    this.svg.selectAll(\"path.arc\").transition(\"opacity\").duration(500).attr({\n      opacity: function(d,i) {\n        var issrc = d3.select(this).classed(\"src\");\n        return (!that.target || (\n          (issrc && that.target.side == \"src\" && d.key == that.target.src) || \n          (!issrc && that.target.side == \"des\" && d.key == that.target.des) ||\n          (that.target.side == null && (\n            (d.key == that.target.src && issrc) ||\n            (d.key == that.target.des && !issrc)\n          ))\n        ) ? 1 : 0.2);\n      },\n    });\n    getp = function(p) {\n      return [Math.sin(p) * (that.size - that.thick),\n        -Math.cos(p) * (that.size - that.thick)];\n    };\n    getc = function(p, q, r) {\n      if(typeof(r) == \"undefined\") r = 3;\n      return [\"C\", p[0]/r, p[1]/r, q[0]/r, q[1]/r, q[0], q[1]];\n    }\n    sel = this.svg.selectAll(\"path.chord\");\n    if(this.inited) sel = sel.transition(\"morph\").duration(500);\n    sel.attr({\n      d: function(d,i) {\n        var src = d.coord.src, des = d.coord.des;\n        var src1 = that.srcAscale(src.node.offset + src.node.percent * src.offset);\n        var src2 = that.srcAscale(src.node.offset + src.node.percent * (src.offset + src.percent));\n        var des1 = that.desAscale(des.node.offset + des.node.percent * des.offset);\n        var des2 = that.desAscale(des.node.offset + des.node.percent * (des.offset + des.percent));\n        var c1 = 0, c2 = 0;\n        var p1 = getp(src1), p2 = getp(src2), p3 = getp(des1), p4 = getp(des2);\n        var s = that.size - that.thick;\n        return [\n          [\"M\", p1[0], p1[1]],\n          [\"A\", s, s, 0, 0, 0, p2[0], p2[1]],\n          getc(p2, p4),\n          [\"A\", s, s, 0, 0, 0, p3[0], p3[1]],\n          getc(p3, p1)\n        ].reduce(function(a,b) { return a.concat(b); }, []).join(\" \");\n      },\n      fill: function(d,i) {\n        return that.color(d.coord.des.node.key);\n      },\n      stroke: \"#fff\",\n      \"stroke-width\": 1\n    });\n    this.svg.selectAll(\"path.chord\").transition(\"opacity\").duration(500).attr({\n      opacity: function(d,i) {\n        if(!that.target) return 0.5;\n        if(that.target && (\n          (that.target.side == \"src\" && that.target.src == d.src) ||\n          (that.target.side == \"des\" && that.target.des == d.des) ||\n          (that.target.side == null && that.target.src == d.src && that.target.des == d.des)\n        )) return 1;\n        else return 0.1;\n      }\n    });\n    this.inited = true;\n  }\n});\n"},"assets":[],"config":{"fontSize":{"name":"Font Size","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":13,"category":"Global Settings","value":"12"},"margin":{"name":"Margin","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":10,"category":"Global Settings","value":10},"padding":{"name":"Padding","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":10,"category":"Global Settings","value":10},"palette":{"name":"Palette","type":[{"name":"Palette","level":30,"re":{},"default":{"colors":[{"hex":"#1d3263"},{"hex":"#226c87"},{"hex":"#f8d672"},{"hex":"#e48e11"},{"hex":"#e03215"},{"hex":"#ab2321"}]},"plotdb":{"colors":[{"hex":"#ed1d78"},{"hex":"#c59b6d"},{"hex":"#8cc63f"},{"hex":"#28aae2"}]},"qualitative":{"colors":[{"hex":"#c05ae0"},{"hex":"#cf2d0c"},{"hex":"#e9ab1e"},{"hex":"#86ffb5"},{"hex":"#64dfff"},{"hex":"#003f7d"}]},"binary":{"colors":[{"hex":"#ff8356"},{"hex":"#0076a1"}]},"sequential":{"colors":[{"hex":"#950431"},{"hex":"#be043e"},{"hex":"#ec326d"},{"hex":"#fc82a9"},{"hex":"#febed2"},{"hex":"#fee6ee"}]},"diverging":{"colors":[{"hex":"#74001a"},{"hex":"#cd2149"},{"hex":"#f23971"},{"hex":"#ff84ab"},{"hex":"#ffc3d7"},{"hex":"#f2f2dd"},{"hex":"#b8d9ed"},{"hex":"#81b1d0"},{"hex":"#3d8bb7"},{"hex":"#0071a8"},{"hex":"#003558"}]},"subtype":{"qualitative":"qualitative","binary":"binary","sequential":"sequential","diverging":"diverging"},"scale":{}}],"default":{"colors":[{"hex":"#f4502a"},{"hex":"#f1c227"},{"hex":"#008a6d"},{"hex":"#00acdb"},{"hex":"#0064a8"}]},"category":"Global Settings","value":{"colors":[{"hex":"#f4502a"},{"hex":"#f1c227"},{"hex":"#008a6d"},{"hex":"#00acdb"},{"hex":"#0064a8"}]}},"otherLimit":{"rebindOnChange":true,"name":"Small Data Threshold","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"desc":"Data smaller than this value will be clustered into one set of data","default":0,"category":"Value","value":"0"},"otherLabel":{"rebindOnChange":true,"name":"Label for 'other'","type":[{"name":"String","default":"","level":2,"basetype":[]}],"default":"Other","category":"Text","value":"Other"},"thick":{"name":"Thickness","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":20,"value":20}},"dimlen":3,"dimension":{"src":{"type":[],"require":true,"desc":"name of source node","fields":[]},"des":{"type":[],"require":true,"desc":"name of destination node","fields":[]},"size":{"type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"require":true,"desc":"flow size","fields":[]}},"library":["d3/3.5.12/min","plotd3/0.1.0"],"createdtime":"2016-04-17T13:24:25.000Z","modifiedtime":"2016-09-21T23:14:53.000Z","local":null,"ownername":"plotdb","data":[]},
{"_type":{"location":"server","name":"chart"},"owner":4,"key":2013,"permission":{"list":[{"perm":"fork","type":"global","target":null,"displayname":"Everyone","username":"and anonymous user"}],"switch":"publish"},"name":"Ternary Plot","theme":null,"parent":null,"description":"ternary plot is useful when we want to visualize 3 dimensional data that sum up to a constant. For example, we can define one's characteristic with  courage, wisdom and strength, summing up them to 100%, and use ternary plot to identify charisma of characters.","basetype":["18"],"visualencoding":["1"],"category":["5"],"tags":["attribute","character"],"likes":0,"searchable":true,"doc":{"name":"document","size":0,"type":"html","lines":1,"content":""},"style":{"name":"stylesheet","size":0,"type":"css","lines":1,"content":""},"code":{"name":"code","size":6341,"type":"javascript","lines":162,"content":"var module = {};\nmodule.exports = plotdb.chart.create({\n  sample: function() {\n    var list = d3.range(10);\n    return {\n      value1: [{name: \"Value1\", data: list.map(function(d,i) { return Math.round(100*Math.random()); })}],\n      value2: [{name: \"Value2\", data: list.map(function(d,i) { return Math.round(100*Math.random()); })}],\n      value3: [{name: \"Value3\", data: list.map(function(d,i) { return Math.round(100*Math.random()); })}],\n    };\n  },\n  dimension: {\n    value1: { type: [plotdb.Number], require: true, desc: \"\" },\n    value2: { type: [plotdb.Number], require: true, desc: \"\" },\n    value3: { type: [plotdb.Number], require: true, desc: \"\" }\n  },\n  config: {\n    margin: {},\n    fontSize: {},\n    gridStroke: {},\n    palette: {default: {colors:[{hex:\"#f00\"},{hex:\"#0f0\"},{hex:\"#00f\"}]}},\n    value1Label: { name: \"Value 1 Label\", extend: \"xAxisLabel\" },\n    value2Label: { name: \"Value 2 Label\", extend: \"xAxisLabel\" },\n    value3Label: { name: \"Value 3 Label\", extend: \"xAxisLabel\" },\n  },\n  init: function() {\n    var that = this;\n    this.svg = d3.select(this.root).append(\"svg\");\n    this.gridGroup = this.svg.append(\"g\").attr({class: \"grid-group\"});\n    this.dataGroup = this.svg.append(\"g\").attr({class: \"data-group\"});\n    this.frame = this.gridGroup.append(\"path\").attr({class: \"frame\"});\n    this.tooltip = plotd3.html.tooltip(this.root).on(\"mousemove\", function(d,i,popup) {\n      popup.select(\".value\").text([d.value1,d.value2,d.value3].join(\" / \"));\n    });\n    this.gridGroup.append(\"text\").attr({class: \"value1\"});\n    this.gridGroup.append(\"text\").attr({class: \"value2\"});\n    this.gridGroup.append(\"text\").attr({class: \"value3\"});\n  },\n  calc: function(v) {\n    var SQRT32 = Math.sqrt(3)/2;\n    return [\n      0.5 * (2 * v[1] + v[2]) / (v[0] + v[1] + v[2]),\n      SQRT32 * v[2] / (v[0] + v[1] + v[2])\n    ];\n  },\n  parse: function() {\n    var that = this;\n    var SQRT32 = Math.sqrt(3)/2;\n    this.data.map(function(d,i) {\n      if(!d.value1) d.value1 = 0;\n      if(!d.value2) d.value2 = 0;\n      if(!d.value3) d.value3 = 0;\n      d.sum = d.value1 + d.value2 + d.value3;\n      if(d.sum==0) d.value1 = d.sum = 1;\n      d.values = [d.value1, d.value2, d.value3].map(function(v,i) { return v/d.sum; });\n      d.coord = that.calc(d.values);\n    });\n  },\n  bind: function() {\n    var that = this,sel;\n    sel = this.dataGroup.selectAll(\"circle.data\").data(this.data);\n    sel.exit().remove();\n    sel = sel.enter().append(\"circle\").attr({class: \"data\"});\n    this.tooltip.nodes(sel);\n    this.ticks = d3.range(4).map(function(d,i) { return (d/5) + (1/5); });\n    [\"value1\",\"value2\",\"value3\"].map(function(name) {\n      sel = that.gridGroup.selectAll(\"line.grid.\" + name).data(that.ticks);\n      sel.exit().remove();\n      sel.enter().append(\"line\").attr({class: \"grid \" + name});\n    });\n  },\n  resize: function() {\n    var that = this;\n    var box = this.root.getBoundingClientRect();\n    var width = this.width = box.width;\n    var height = this.height = box.height;\n    var SQRT32 = Math.sqrt(3)/2;\n    if(width > height - this.config.fontSize * 4) {\n      this.size = (height - this.config.margin * 2 - this.config.fontSize * 4) / SQRT32;\n    } else {\n      this.size = (width - this.config.margin * 2);\n    }\n    this.xMin = (this.width - this.size)/2;\n    this.xMax = (this.width + this.size)/2;\n    this.yMin = (this.height - this.size * SQRT32)/2;\n    this.yMax = (this.height + this.size * SQRT32)/2;\n    this.tooltip.fontSize(this.config.fontSize);\n    this.svg.attr({\n      width: width + \"px\", height: height + \"px\",\n      viewBox: [0,0,width,height].join(\" \"),\n      preserveAspectRatio: \"xMidYMid\"\n    });\n    this.xScale = d3.scale.linear()\n      .domain([0,1])\n      .range([this.xMin, this.xMax]);\n    this.yScale = d3.scale.linear()\n      .domain([0,SQRT32])\n      .range([this.yMax, this.yMin]);\n  },\n  render: function() {\n    var that = this,sel;\n    var SQRT32 = Math.sqrt(3)/2;\n    var c1 = d3.rgb((this.config.palette.colors[0] || {}).hex || \"#f00\");\n    var c2 = d3.rgb((this.config.palette.colors[1] || {}).hex || \"#0f0\");\n    var c3 = d3.rgb((this.config.palette.colors[2] || {}).hex || \"#00f\");\n    this.frame.attr({\n      d: [\n        \"M\", this.xMin, this.yMax,\n        \"L\", this.xMax, this.yMax,\n        \"L\", (this.width/2), this.yMin,\n        \"Z\"\n      ].join(\" \"),\n      fill: \"none\",\n      stroke: \"black\",\n      \"stroke-width\": 2\n    });\n    sel = this.dataGroup;\n    if(this.inited) sel = sel.transition(\"morph\").duration(500);\n    sel.selectAll(\"circle.data\").attr({\n      cx: function(d,i) { return that.xScale(d.coord[0]); },\n      cy: function(d,i) { return that.yScale(d.coord[1]); },\n      r: 4,\n      fill: \"white\",\n      stroke: function(d,i) {\n        var c = [\"r\",\"g\",\"b\"].map(function(v,i) {\n          return parseInt(c1[v] * d.values[i] + c2[v] * d.values[i] + c3[v] * d.values[i]);\n        });\n        return d3.rgb(c[0], c[1], c[2]).toString()\n      },\n      \"stroke-width\": 2\n    });\n    [\"value1\",\"value2\",\"value3\"].map(function(name,i) {\n      that.gridGroup.selectAll(\"line.grid.\"+name).each(function(d) {\n        var p1 = [1,0], p2 = [0,1],v = (d/(1-d));\n        p1.splice(i,0,v);\n        p2.splice(i,0,v);\n        p1 = that.calc(p1);\n        p2 = that.calc(p2);\n        d3.select(this).attr({\n          x1: that.xScale(p1[0]), x2: that.xScale(p2[0]),\n          y1: that.yScale(p1[1]), y2: that.yScale(p2[1]),\n          stroke: that.config.gridStroke,\n          \"stroke-width\": 1\n        });\n      });\n    });\n    this.gridGroup.selectAll(\"text\").attr(\"font-size\", this.config.fontSize);\n    this.gridGroup.select(\"text.value1\").attr({\n      x: this.xMin, y: this.yMax, dy: this.config.fontSize * 1.3,\n      fill: c1.darker().toString()\n    }).text(this.config.value1Label || this.dimension.value1.fieldName || \" \");\n    this.gridGroup.select(\"text.value2\").attr({\n      x: this.xMax, y: this.yMax, dy: this.config.fontSize * 1.3, \"text-anchor\": \"end\",\n      fill: c2.darker().toString()\n    }).text(this.config.value2Label || this.dimension.value2.fieldName || \" \");\n    this.gridGroup.select(\"text.value3\").attr({\n      x: this.width/2, y: this.yMin, dy: -this.config.fontSize * 0.5, \"text-anchor\": \"middle\",\n      fill: c3.darker().toString()\n    }).text(this.config.value3Label || this.dimension.value3.fieldName || \" \");\n    this.inited = true;\n  }\n});\n"},"assets":[],"config":{"margin":{"name":"Margin","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":10,"category":"Global Settings","value":10},"fontSize":{"name":"Font Size","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":13,"category":"Global Settings","value":"12"},"gridStroke":{"name":"Color","type":[{"name":"Color","level":10,"default":"#dc4521","Gray":"#cccccc","Positive":"#3f7ab5","Negative":"#d93510","Neutral":"#cccccc","Empty":"#ffffff","subtype":{"negative":"negative","positive":"positive","neutral":"neutral"}}],"default":"#ccc","category":"Grid","value":"#cccccc"},"palette":{"default":{"colors":[{"hex":"#f00"},{"hex":"#0f0"},{"hex":"#00f"}]},"name":"Palette","type":[{"name":"Palette","level":30,"re":{},"default":{"colors":[{"hex":"#1d3263"},{"hex":"#226c87"},{"hex":"#f8d672"},{"hex":"#e48e11"},{"hex":"#e03215"},{"hex":"#ab2321"}]},"plotdb":{"colors":[{"hex":"#ed1d78"},{"hex":"#c59b6d"},{"hex":"#8cc63f"},{"hex":"#28aae2"}]},"qualitative":{"colors":[{"hex":"#c05ae0"},{"hex":"#cf2d0c"},{"hex":"#e9ab1e"},{"hex":"#86ffb5"},{"hex":"#64dfff"},{"hex":"#003f7d"}]},"binary":{"colors":[{"hex":"#ff8356"},{"hex":"#0076a1"}]},"sequential":{"colors":[{"hex":"#950431"},{"hex":"#be043e"},{"hex":"#ec326d"},{"hex":"#fc82a9"},{"hex":"#febed2"},{"hex":"#fee6ee"}]},"diverging":{"colors":[{"hex":"#74001a"},{"hex":"#cd2149"},{"hex":"#f23971"},{"hex":"#ff84ab"},{"hex":"#ffc3d7"},{"hex":"#f2f2dd"},{"hex":"#b8d9ed"},{"hex":"#81b1d0"},{"hex":"#3d8bb7"},{"hex":"#0071a8"},{"hex":"#003558"}]},"subtype":{"qualitative":"qualitative","binary":"binary","sequential":"sequential","diverging":"diverging"},"scale":{}}],"category":"Global Settings","value":{"colors":[{"hex":"#f00"},{"hex":"#0f0"},{"hex":"#00f"}]}},"value1Label":{"name":"Value 1 Label","extend":"xAxisLabel","type":[{"name":"String","default":"","level":2,"basetype":[]}],"default":"","category":"X Axis","value":"zymotic rate"},"value2Label":{"name":"Value 2 Label","extend":"xAxisLabel","type":[{"name":"String","default":"","level":2,"basetype":[]}],"default":"","category":"X Axis","value":"wound rate"},"value3Label":{"name":"Value 3 Label","extend":"xAxisLabel","type":[{"name":"String","default":"","level":2,"basetype":[]}],"default":"","category":"X Axis","value":"other"}},"dimlen":3,"dimension":{"value1":{"type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"require":true,"desc":"","fields":[{"dataset":null,"location":"sample","name":"zymotic rate(‰)","datatype":null,"data":[],"datasetname":"Crimean War 1854"}]},"value2":{"type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"require":true,"desc":"","fields":[{"dataset":null,"location":"sample","name":"wound rate(‰)","datatype":null,"data":[],"datasetname":"Crimean War 1854"}]},"value3":{"type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"require":true,"desc":"","fields":[{"dataset":null,"location":"sample","name":"other rate(‰)","datatype":null,"data":[],"datasetname":"Crimean War 1854"}]}},"library":["d3/3.5.12/min","plotd3/0.1.0"],"createdtime":"2016-07-24T00:32:02.000Z","modifiedtime":"2016-07-24T18:21:03.000Z","local":null,"ownername":"plotdb","data":[]},
{"_type":{"location":"server","name":"chart"},"owner":4,"key":1017,"permission":{"list":[{"perm":"fork","type":"global","target":null,"username":"and anonymous user","displayname":"Everyone"}],"value":[],"switch":"publish"},"name":"Voronoi Treemap","theme":null,"parent":null,"description":"Specialized treemap in which the area is divided by weighted voronoi diagram.","basetype":["8"],"visualencoding":["6"],"category":["1","4"],"tags":["voronoi","treemap","area"],"likes":null,"searchable":true,"doc":{"name":"document","size":0,"type":"html","lines":1,"content":""},"style":{"name":"stylesheet","size":0,"type":"css","lines":1,"content":""},"code":{"name":"code","size":6518,"type":"javascript","lines":185,"content":"var module = {};\nmodule.exports = plotdb.chart.create({\n  sample: function() {\n    var list = d3.range(20);\n    return {\n      value: [{name: \"Score\", data: list.map(function(d,i) { return Math.round(Math.random() * 90 + 10); })}],\n      name: [{name: \"Name\", data: list.map(function(d,i) { return plotdb.data.sample.name.rand(); })}],\n      category: [{name: \"Dept\", data: list.map(function(d,i) { return plotdb.data.sample.category.rand(); })}]\n    };\n  },\n  dimension: {\n    value: { type: [plotdb.Number], require: true, desc: \"size of the block\" },\n    name: { type: [], require: false, desc: \"name of the block\" },\n    category: { type: [], require: false, desc: \"parent of the block\"}\n  },\n  config: {\n    fontSize: {},\n    margin: {},\n    palette: {},\n    legendLabel: {},\n    labelShadowSize: {},\n  },\n  init: function() {\n    var that = this;\n    this.svg = d3.select(this.root).append(\"svg\");\n    this.legendGroup = this.svg.append(\"g\").attr({class: \"legend-group\"});\n    setInterval(function() {\n      that.tick();\n    }, 30);\n  },\n  parse: function() {\n    this.data.map(function(it) { \n      it.key = it.name;\n      it.data = it.value;\n    });\n    this.categories = d3.map(this.data, function(d,i) { return d.category; }).keys();\n    this.parsed = {children: d3.nest().key(function(it) { return it.category; }).entries(this.data).map(function(it) {\n      it.children = it.values;\n      return it;\n    })};\n  },\n  bind: function() {\n    var that = this, sel;\n    var sites = this.treemap.getSites();\n    sel = this.svg.selectAll(\"path.data\").data(this.treemap.getPolygons());\n    sel.exit().remove();\n    sel.enter().append(\"path\").attr({\"class\": \"data\", opacity: 1});\n    this.svg.selectAll(\"path.data\").attr({\n      class: function(d,i) {\n        return (sites[i].lv <=0 ? \"data group\" : \"data\");\n      }\n    });\n    this.polygons = this.svg.selectAll(\"path.data\");\n    sel = this.svg.selectAll(\"g.label\").data(sites);\n    sel.exit().remove();\n    sel.enter().append(\"g\").attr({\"class\": \"label\"}).each(function(it) {\n      var node = d3.select(this);\n      node.append(\"text\").attr({\"class\": \"name shadow\"});\n      node.append(\"text\").attr({\"class\": \"value shadow\"});\n      node.append(\"text\").attr({\"class\": \"name\"});\n      node.append(\"text\").attr({\"class\": \"value\"});\n    });\n    this.sites = this.svg.selectAll(\"g.label\");\n  },\n  resize: function() {\n    var that = this;\n    var box = this.root.getBoundingClientRect();\n    var width = this.width = box.width;\n    var height = this.height = box.height;\n    this.svg.attr({\n      width: width + \"px\", height: height + \"px\",\n      viewBox: [0,0,width,height].join(\" \"),\n      preserveAspectRatio: \"xMidYMid\"\n    });\n    this.cScale = plotdb.Palette.scale.ordinal(this.config.palette);\n    this.legend = plotd3.rwd.legend()\n      .scale(this.cScale)\n      .orient(\"bottom\")\n      .tickValues(this.categories)\n      .size([this.width - 2 * this.config.margin, 100])\n      .fontSize(this.config.fontSize);\n    this.legend.label(this.config.legendLabel || this.dimension.value.fieldName || \"\");\n    this.legendGroup.call(this.legend).selectAll(\".legend\").on(\"mouseover\", function(d,i) {\n      var sites = that.treemap.getSites();\n      that.activeGroup = d;\n      that.polygons.transition().attr({\n        opacity: function(d,i) {\n          var data = sites[i];\n          return (!that.activeGroup || that.activeGroup == data.key || that.activeGroup == data.category ? 1 : 0.1);\n        }\n      });\n    }).on(\"mouseout\", function(d,i) {\n      that.activeGroup = null;\n      that.polygons.transition().attr({ opacity: 1 });\n    });\n    this.legendSize = this.legend.offset();\n    this.xScale = d3.scale.linear().domain([0,width]).range([\n      this.config.margin, \n      width - this.config.margin\n    ]);\n    this.yScale = d3.scale.linear().domain([0,height]).range([\n      this.config.margin, \n      height - this.config.margin - this.legendSize[1] - this.config.fontSize\n    ]);\n    this.treemap = new Voronoi.Treemap(this.parsed, Voronoi.Polygon.create(width, height, 60), width, height);\n  },\n  tick: function() {\n    if(!this.treemap) return ;this.treemap.compute();\n    this.render();\n  },\n  render: function() {\n    var that = this;\n    var sites = this.treemap.getSites();\n    var polygons = this.treemap.getPolygons();\n    this.legendGroup.attr({\n      transform: [\"translate(\", (this.width - this.legendSize[0])/2, (this.height - this.legendSize[1] - this.config.margin), \")\"].join(\" \")\n    });\n    this.polygons.data(polygons).attr({\n      d: function(it) {\n        if(!it || !it.length) return \"\"\n        ret = [\"M\", that.xScale(it[0].x), that.yScale(it[0].y)];\n        for(var idx = 0; idx < it.length; idx++) {\n          ret.push(\"L\");\n          ret.push(that.xScale(it[idx].x));\n          ret.push(that.yScale(it[idx].y));\n        }\n        ret.push(\"L\");\n        ret.push(that.xScale(it[0].x));\n        ret.push(that.yScale(it[0].y));\n        return ret.join(\" \");\n      },\n      fill: function(it,i) {\n        if(sites[i].lv == 0) return that.cScale(sites[i].key);\n        else return \"none\"\n      },\n      stroke: \"#000\",\n      \"stroke-width\": function(it,i) {\n        if(sites[i].lv <= 0) return 5;\n        return 1;\n      }\n    });\n    this.sites.attr({\n      transform: function(it) {\n        var x = that.xScale(it.x);\n        var y = that.yScale(it.y);\n        if(isNaN(x)) x = -10000;\n        if(isNaN(y)) y = -10000;\n        return [\"translate(\", x, y, \")\"].join(\" \");\n      },\n      \"font-size\": that.config.fontSize,\n    }).each(function(it) {\n      var node = d3.select(this);\n      attr = {\n        fill: function(it) {\n          var hsl = d3.hsl(that.cScale(it.category));\n          if(hsl.l > 0.65) return \"#000\";\n          return \"#fff\";\n        },\n        \"text-anchor\": \"middle\",\n        \"dominant-baseline\": \"central\"\n      };\n      node.selectAll(\"text.name\").attr(attr).attr(\"dy\", -that.config.fontSize/2).text(function(it) {\n        if(it.lv >= 1) return it.name;\n        return \"\";\n      });\n      node.selectAll(\"text.value\").attr(attr).attr({\n        dy: that.config.fontSize/2,\n        \"font-size\": \"0.8em\",\n        \"font-weight\": \"200\"\n      }).text(function(it) {\n        if(it.lv >= 1) return Math.round(100*it.data)/100;\n        return \"\";\n      });\n      node.selectAll(\"text.shadow\").attr({\n        stroke: function(it) {\n          var hsl = d3.hsl(that.cScale(it.category));\n          if(hsl.l > 0.65) return \"#fff\";\n          return \"#000\";\n        },\n        \"stroke-width\": that.config.labelShadowSize\n      });\n    });\n  }\n});\n"},"assets":[],"config":{"fontSize":{"name":"Font Size","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":13,"category":"Text","value":"12"},"margin":{"name":"Margin","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":10,"category":"Layout","value":"10"},"palette":{"name":"Palette","type":[{"name":"Palette","level":30,"re":{},"default":{"colors":[{"hex":"#1d3263"},{"hex":"#226c87"},{"hex":"#f8d672"},{"hex":"#e48e11"},{"hex":"#e03215"},{"hex":"#ab2321"}]},"plotdb":{"colors":[{"hex":"#ed1d78"},{"hex":"#c59b6d"},{"hex":"#8cc63f"},{"hex":"#28aae2"}]},"qualitative":{"colors":[{"hex":"#c05ae0"},{"hex":"#cf2d0c"},{"hex":"#e9ab1e"},{"hex":"#86ffb5"},{"hex":"#64dfff"},{"hex":"#003f7d"}]},"binary":{"colors":[{"hex":"#ff8356"},{"hex":"#0076a1"}]},"sequential":{"colors":[{"hex":"#950431"},{"hex":"#be043e"},{"hex":"#ec326d"},{"hex":"#fc82a9"},{"hex":"#febed2"},{"hex":"#fee6ee"}]},"diverging":{"colors":[{"hex":"#74001a"},{"hex":"#cd2149"},{"hex":"#f23971"},{"hex":"#ff84ab"},{"hex":"#ffc3d7"},{"hex":"#f2f2dd"},{"hex":"#b8d9ed"},{"hex":"#81b1d0"},{"hex":"#3d8bb7"},{"hex":"#0071a8"},{"hex":"#003558"}]},"subtype":{"qualitative":"qualitative","binary":"binary","sequential":"sequential","diverging":"diverging"},"scale":{}}],"default":{"colors":[{"hex":"#1d3263"},{"hex":"#226c87"},{"hex":"#f8d672"},{"hex":"#e48e11"},{"hex":"#e03215"},{"hex":"#ab2321"}]},"category":"Color","value":{"colors":[{"hex":"#1d3263"},{"hex":"#226c87"},{"hex":"#f8d672"},{"hex":"#e48e11"},{"hex":"#e03215"},{"hex":"#ab2321"}]}},"legendLabel":{"name":"Legend Label","type":[{"name":"String","default":"","level":2,"basetype":[]}],"category":"Text"},"labelShadowSize":{"name":"Label Shadow Size","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":2,"category":"Text","value":"2"}},"dimension":{"value":{"type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"require":true,"desc":"size of the block","fields":[]},"name":{"type":[],"require":false,"desc":"name of the block","fields":[]},"category":{"type":[],"require":false,"desc":"parent of the block","fields":[]}},"library":["d3/3.5.12/min","plotd3/0.1.0","voronoijs/0.0.1/min"],"dimlen":3,"createdtime":"2016-02-29T16:47:57.000Z","modifiedtime":"2016-08-09T09:48:27.000Z","local":null,"ownername":"plotdb","data":[]},
{"_type":{"location":"server","name":"chart"},"owner":4,"key":968,"permission":{"list":[{"perm":"fork","type":"global","target":null,"username":"and anonymous user","displayname":"Everyone"}],"value":[],"switch":"publish"},"name":"Nightingale's Rose","theme":null,"parent":null,"description":"A classic chart which was used by Nightingale in 1959 to depict the deaths in hospital in Crimea war.","basetype":["6"],"visualencoding":["6"],"category":["5"],"tags":["nightingale","crimeanwar","polar","windrose","wind","rose"],"likes":null,"searchable":true,"doc":{"name":"document","size":0,"type":"html","lines":1,"content":""},"style":{"name":"stylesheet","size":0,"type":"css","lines":1,"content":""},"code":{"name":"code","size":9615,"type":"javascript","lines":245,"content":"var module = {};\nmodule.exports = plotdb.chart.create({\n  sample: function() { \n    var vlist = d3.range(3), list = d3.range(12);\n    return {\n      values: vlist.map(function(d,i) { return {\n        name: plotdb.data.sample.name[d],\n        data: list.map(function(d,j) { return Math.round(1 + Math.abs(6 - j) + Math.sin(i/2 + j * Math.PI / list.length) * (5 + i));  })\n      }; }),\n      order: [{name: \"Year\", data: list.map(function(d,i) { return d + 1995; })}]\n    };\n  },\n  dimension: {\n    values: { type: [plotdb.Number], require: true, multiple: true, desc: \"Wedge Size\" },\n    order: { type: [plotdb.Order], require: false, desc: \"Order of Wedge\" }\n  },\n  config: {\n    fontSize: {},\n    margin: {},\n    palette: {},\n    legendShow: {},\n    legendLabel: {},\n    gridShow: {},\n    gridStroke: {},\n    gridStrokeWidth: {},\n    rAxisShow: {},\n    rAxisLabel: {},\n    rAxisTickSizeInner: {},\n    rAxisTickSizeOuter: {},\n    rAxisTickPadding: {},\n    rAxisShowDomain: {default: true},\n    rAxisTickCount: {},\n    rAxisLabelPosition: {}\n  },\n  init: function() {\n    var that = this;\n    this.svg = d3.select(this.root).append(\"svg\");\n    this.legendGroup = this.svg.append(\"g\").attr({class: \"legend-group\"});\n    this.gridGroup = this.svg.append(\"g\").attr({class: \"grid-group\"});\n    this.dataGroup = this.svg.append(\"g\").attr({class: \"data-group\"});\n    this.popup = plotd3.html.popup(this.root).on(\"mousemove\", function(d,i,popup) {\n      popup.select(\".title\").text(that.names[d.field]);\n      popup.select(\".value div\").text(d.order);\n      popup.select(\".value span\").text(d.value);\n    });\n    this.frame = this.svg.append(\"circle\").attr({class: \"grid frame\"});\n    this.popup.getPopupNode().select(\".value\").call(function(d,i) {\n      this.append(\"div\"); this.append(\"span\");\n    });\n    this.aAxisGroup = this.svg.append(\"g\").attr({class: \"axis angle\"});\n    this.rAxisGroup = this.svg.append(\"g\").attr({class: \"axis radius\"});\n  },\n  parse: function() {\n    var that = this, extents;\n    plotdb.Order.sort(this.data, \"order\");      \n    extents = this.data.map(function(d,i) { return d3.extent(d.values); });\n    this.valueRange = d3.extent([0,1].map(function(it) {\n      return d3.extent(extents.map(function(d,i) { return d[it]; }));\n    }).reduce(function(a,b) { return a.concat(b); },[]));\n    if(this.valueRange[0] == this.valueRange[1]) this.valueRange[1]++;\n    this.names = this.dimension.values.fieldName;\n    this.data.map(function(d,i) {\n      d.idx = i;\n      d.parsed = d.values.map(function(v,j) { return {value: v, order: d.order, idx: i, field: j};}); \n      d.parsed.sort(function(a,b) { return (b.value - a.value); });\n    });\n  },\n  bind: function() {\n    var that = this, sel;\n    sel = this.dataGroup.selectAll(\"g.data\").data(this.data);\n    sel.exit().remove();\n    sel = sel.enter().append(\"g\").attr({class: \"data\"});\n    this.dataGroup.selectAll(\"g.data\").each(function(d,i) {\n      var node = d3.select(this);\n      node.selectAll(\"path.data\").data(d.parsed)\n        .enter().append(\"path\").attr({class: \"data\"});\n    });\n    sel = this.aAxisGroup.selectAll(\"g.tick\").data(this.data);\n    sel.exit().remove();\n    sel.enter().append(\"g\").attr({class: \"tick\"}).each(function(d,i) {\n      var node = d3.select(this);\n      node.append(\"text\").attr({class: \"shadow\"});\n      node.append(\"text\");\n    });\n    this.popup.nodes(this.svg.selectAll(\"path.data\"));\n  },\n  resize: function() {\n    var that = this, box = this.root.getBoundingClientRect();\n    this.width = box.width;\n    this.height = box.height;\n    this.svg.attr({\n      width: this.width + \"px\", height: this.height + \"px\",\n      viewBox: [0,0,this.width,this.height].join(\" \"),\n      preserveAspectRatio: \"xMidYMid\"\n    });\n    this.popup.fontSize(this.config.fontSize);\n    this.cScale = plotdb.Palette.scale.ordinal(this.config.palette);\n    this.legend = plotd3.rwd.legend()\n      .scale(this.cScale)\n      .orient(\"right\")\n      .tickValues(this.names)\n      .label(this.config.legendLabel || \" \")\n      .size([220,this.height - 2 * this.config.margin])\n      .fontSize(this.config.fontSize);\n    this.legendGroup.call(this.legend).selectAll(\".legend\").on(\"mouseover\", function(d,i) {\n      that.activeGroup = i + 1;\n      that.render();\n    }).on(\"mouseout\", function(d,i) {\n      that.activeGroup = null;\n      that.render();\n    });\n    this.legendSize = (this.config.legendShow ? this.legend.offset() : [0,0]);\n    this.aScale = d3.scale.linear()\n      .domain([0, this.data.length])\n      .range([0, Math.PI * 2]);\n    var mw = this.width - this.config.margin * 2 - this.config.fontSize * 4\n        - (this.config.legendShow ? this.legendSize[0] + this.config.fontSize: 0) ;\n    var mh = this.height - this.config.margin * 2 - this.config.fontSize * 2;\n    this.size = (mw > mh? mh : mw) / 2;\n\n    this.rScale = d3.scale.sqrt()\n      .domain([0, this.valueRange[1]])\n      .range([this.height/2, this.height/2 - this.size]);\n    this.rAxis = plotd3.rwd.axis()\n      .scale(this.rScale)\n      .orient(\"left\")\n      .fontSize(this.config.fontSize)\n      .label(this.config.rAxisLabel || \"\")\n      .labelPosition(this.config.rAxisLabelPosition)\n      .tickValues(this.rScale.ticks(this.config.rAxisTickCount))\n      .tickSize(this.config.rAxisTickSizeInner, this.config.rAxisTickSizeOuter)\n      .tickPadding(this.config.rAxisTickPadding);\n    this.rAxisGroup.call(this.rAxis).select(\".domain\").remove();\n    this.rAxisWidth = (this.config.rAxisShow ? this.rAxis.offset() : 0);\n    mw = this.width - this.config.margin * 2 - this.config.fontSize * 4\n      - (this.config.rAxisShow ? this.rAxisWidth + this.config.fontSize : 0)\n      - (this.config.legendShow ? this.legendSize[0] + this.config.fontSize: 0);\n    this.size = (mw > mh? mh : mw) / 2\n    this.rScale.range([this.height/2, this.height/2 - this.size]);\n    this.rAxisGroup.call(this.rAxis);\n    this.rAxisWidth = (this.config.rAxisShow ? this.rAxis.offset() : 0);\n    this.rScale = d3.scale.sqrt()\n      .domain([0, this.valueRange[1]])\n      .range([0, this.size]);\n    this.maxWidth = this.size * Math.PI * 2 / (this.data.length || 1);\n    this.cx = this.width/2;\n    var sel = this.gridGroup.selectAll(\"circle.grid.radial\").data(this.rAxis.tickValues());\n    sel.exit().remove();\n    sel.enter().append(\"circle\").attr({class: \"grid radial\"});\n  },\n  render: function() {\n    var that = this,sel;\n    this.aAxisGroup.attr({\n      transform: [\"translate(\", this.cx, this.height/2, \")\"].join(\" \")\n    }).selectAll(\".tick\").transition(\"morph\").duration(this.inited ? 500 : 0).attr({\n      transform: function(d,i) {\n        var r = that.rScale(d3.max(d.values)) + that.config.fontSize /2;\n        var a = that.aScale(i + 0.5);\n        var x = Math.sin(a) * r;\n        var y = -Math.cos(a) * r;\n        return [\"translate(\", x, y, \") rotate(\", a * 180 / Math.PI, \")\"].join(\" \");\n      }\n    }).each(function(d,i) {\n      var node = d3.select(this);\n      node.selectAll(\"text\").text(d.order).attr({\n        \"font-size\": that.config.fontSize,\n        \"text-anchor\": \"middle\"\n      });\n      node.select(\"text.shadow\").attr({\n        stroke: \"#fff\",\n        \"stroke-width\": 2\n      });\n    });\n    this.gridGroup.selectAll(\"circle\").attr({\n      cx: 0, cy: 0,\n      r: function(d,i) { return that.rScale(d); },\n      fill: \"none\",\n      stroke: this.config.gridStroke,\n      \"stroke-width\": this.config.gridStrokewidth,\n      display: (this.config.gridShow ? \"block\" : \"none\")\n    });\n    this.dataGroup.attr({\n      transform: [\"translate(\", this.cx, this.height/2, \")\" ].join(\" \")\n    });\n    sel =  this.dataGroup.selectAll(\"path.data\");\n    if(this.inited) sel = sel.transition(\"morph\").duration(500);\n    sel.attr({\n      d: function(it) {\n  \t    var i = it.idx;\n        var largeArc = (that.data.length > 1 ? 0 : 1);\n        var r = that.rScale(it.value);\n        var x1 = (Math.sin(that.aScale(i)) * r);\n        var y1 = -(Math.cos(that.aScale(i)) * r);\n        var x2 = (Math.sin(that.aScale(i + 1)) * r);\n        var y2 = -(Math.cos(that.aScale(i + 1)) * r);\n        var ret = [\n          \"M\", 0, 0,\n          \"L\", x1, y1,\n          \"A\", r, r, 0, largeArc, 1, x2, y2,\n          \"L\", 0, 0,\n          \"Z\"\n        ].join(\" \");\n        return ret;\n      },\n      fill: function(d,i) { return that.cScale(that.names[d.field]); },\n      stroke: \"#fff\",\n      \"stroke-width\": 1.5\n    });\n    this.dataGroup.selectAll(\"path.data\").transition(\"opacity\").attr({\n      opacity: function(d,i) {\n        return (!that.activeGroup || that.activeGroup == d.field + 1 ? 1 : 0.1);\n      },\n    });\n    var maxTick = d3.max(this.aAxisGroup.selectAll(\"text.shadow\")[0].map(function(d,i) {\n      return d.getBBox().width;\n    }));\n    if(this.maxWidth < maxTick) this.aAxisGroup.selectAll(\"g.tick\").attr({\n      opacity: function(d,i) { return (i%2?1:0);}\n    });\n    var h = this.dataGroup[0][0].getBoundingClientRect().height;\n    var cy = this.height/2;\n    var offset = {transform: [\n      \"translate(\", this.cx, cy, \")\"\n    ].join(\" \")};\n    this.dataGroup.attr(offset);\n    this.gridGroup.attr(offset);\n    this.aAxisGroup.attr(offset);\n    this.rAxisGroup.attr({\n      transform: [\"translate(\",\n        (this.cx - this.config.fontSize * 2 - this.size),\n        (cy - this.height/2),\n        \")\"].join(\" \"),\n      display: this.config.rAxisShow ? \"block\" : \"none\"\n    });\n    this.legendGroup.attr({\n      transform: [\"translate(\",\n        (this.cx + this.size + this.config.fontSize * 2),\n        (this.height - this.legendSize[1])/2,\n        \")\"].join(\" \"),\n      display: this.config.legendShow ? \"block\" : \"none\"\n    });\n    this.inited = true;\n  }\n});\n"},"assets":[],"config":{"fontSize":{"name":"Font Size","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":13,"category":"Global Settings","value":12},"margin":{"name":"Margin","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":10,"category":"Global Settings","value":"10"},"palette":{"name":"Palette","type":[{"name":"Palette","level":30,"re":{},"default":{"colors":[{"hex":"#1d3263"},{"hex":"#226c87"},{"hex":"#f8d672"},{"hex":"#e48e11"},{"hex":"#e03215"},{"hex":"#ab2321"}]},"plotdb":{"colors":[{"hex":"#ed1d78"},{"hex":"#c59b6d"},{"hex":"#8cc63f"},{"hex":"#28aae2"}]},"qualitative":{"colors":[{"hex":"#c05ae0"},{"hex":"#cf2d0c"},{"hex":"#e9ab1e"},{"hex":"#86ffb5"},{"hex":"#64dfff"},{"hex":"#003f7d"}]},"binary":{"colors":[{"hex":"#ff8356"},{"hex":"#0076a1"}]},"sequential":{"colors":[{"hex":"#950431"},{"hex":"#be043e"},{"hex":"#ec326d"},{"hex":"#fc82a9"},{"hex":"#febed2"},{"hex":"#fee6ee"}]},"diverging":{"colors":[{"hex":"#74001a"},{"hex":"#cd2149"},{"hex":"#f23971"},{"hex":"#ff84ab"},{"hex":"#ffc3d7"},{"hex":"#f2f2dd"},{"hex":"#b8d9ed"},{"hex":"#81b1d0"},{"hex":"#3d8bb7"},{"hex":"#0071a8"},{"hex":"#003558"}]},"subtype":{"qualitative":"qualitative","binary":"binary","sequential":"sequential","diverging":"diverging"},"scale":{}}],"default":{"colors":[{"hex":"#f4502a"},{"hex":"#f1c227"},{"hex":"#008a6d"},{"hex":"#00acdb"},{"hex":"#0064a8"}]},"category":"Global Settings","value":{"colors":[{"hex":"#7a322a"},{"hex":"#f93634"},{"hex":"#dddb83"},{"hex":"#ede6de"},{"hex":"#fdfffa"},{"hex":"#dbdbdb"},{"hex":"#48462d"}]}},"legendShow":{"name":"Show Legend","type":[{"name":"Boolean","default":true,"level":8,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"default":true,"category":"Legend","value":true},"legendLabel":{"name":"Legend Label","type":[{"name":"String","default":"","level":2,"basetype":[]}],"category":"Legend"},"gridShow":{"name":"Show Grid","type":[{"name":"Boolean","default":true,"level":8,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"default":true,"category":"Grid","value":true},"gridStroke":{"name":"Color","type":[{"name":"Color","level":10,"default":"#dc4521","Gray":"#cccccc","Positive":"#3f7ab5","Negative":"#d93510","Neutral":"#cccccc","Empty":"#ffffff","subtype":{"negative":"negative","positive":"positive","neutral":"neutral"}}],"default":"#ccc","category":"Grid","value":"#cccccc"},"gridStrokeWidth":{"name":"Stroke Width","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":1,"category":"Grid","value":1},"rAxisShow":{"name":"Show Axis","type":[{"name":"Boolean","default":true,"level":8,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"default":true,"category":"Radial Axis","value":true},"rAxisLabel":{"name":"Label","type":[{"name":"String","default":"","level":2,"basetype":[]}],"default":"","category":"Radial Axis","value":""},"rAxisTickSizeInner":{"name":"Inner Tick Size","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":4,"category":"Radial Axis","value":4},"rAxisTickSizeOuter":{"name":"Outer Tick Size","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":0,"category":"Radial Axis","value":0},"rAxisTickPadding":{"name":"Tick Padding","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":4,"category":"Radial Axis","value":4},"rAxisShowDomain":{"default":true,"name":"Show Basline","type":[{"name":"Boolean","default":true,"level":8,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"category":"Radial Axis","value":true},"rAxisTickCount":{"name":"Tick Count","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":6,"category":"Radial Axis","desc":"Hint on number of tick. Actual number will be decided by program","value":6},"rAxisLabelPosition":{"name":"Label Position","type":[{"default":"","name":"Choice","level":20,"values":["in","center"]}],"default":"center","category":"Radial Axis","value":"center"}},"dimlen":2,"dimension":{"values":{"type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"require":true,"multiple":true,"desc":"Wedge Size","fields":[]},"order":{"type":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"require":false,"desc":"Order of Wedge","fields":[]}},"library":["d3/3.5.12/min","plotd3/0.1.0"],"createdtime":"2016-02-19T16:48:24.000Z","modifiedtime":"2016-09-21T23:06:48.000Z","local":null,"ownername":"plotdb","data":[]},
{"_type":{"location":"server","name":"chart"},"owner":4,"key":993,"permission":{"list":[{"perm":"fork","type":"global","target":null,"username":"and anonymous user","displayname":"Everyone"}],"value":[],"switch":"publish"},"name":"Bubble Chart","theme":null,"parent":null,"description":"a standard bubble chart","basetype":["5"],"visualencoding":["6"],"category":["1"],"tags":["bubble","size","budget","circle","foam","pack"],"likes":null,"searchable":true,"doc":{"name":"document","size":0,"type":"html","lines":1,"content":""},"style":{"name":"stylesheet","size":0,"type":"css","lines":1,"content":""},"code":{"name":"code","size":7866,"type":"javascript","lines":205,"content":"var module = {};\nmodule.exports = plotdb.chart.create({\n  sample: function() {\n    var count = 30;\n    var value = [{name: \"value\", data: d3.range(count).map(function() { \n      var v = Math.random();\n      if(v < 0.7) return Math.random() + 1;\n      if(v < 0.9) return Math.random() * 5 + 3;\n      return Math.random() * 10 + 6;\n      return Math.random(); \n    })}];\n    var name = [{name: \"name\", data: d3.range(count).map(function() { return plotdb.data.sample.name.rand(); })}];\n    var category = [{name: \"category\", data: d3.range(count).map(function() { return plotdb.data.sample.category.rand(); })}];\n    return {\n      value: value,\n      name: name,\n      category: category\n    };\n  },\n\n  dimension: {\n    value: { type: [plotdb.Number], require: true, desc: \"size of circle\" },\n    name: { type: [], require: false, desc: \"tag of circle\" },\n    category: { type: [], require: false, desc: \"category of circle\"},\n  },\n  config: {\n    fontFamily: {},\n    background: {},\n    fontSize: {},\n    margin: {},\n    bubblePadding: {},\n    palette: {},\n    legendShow: {},\n    labelShadowSize: {},\n    labelShow: {},\n    sort: { type: [plotdb.Choice([\"value\",\"category\",\"name\"])], default: \"value\", rebindOnChange: true},\n    catInBubble: { name: \"Show Category\", type: [plotdb.Boolean], default: true, category: \"Special Settings\"  },\n  },\n  init: function() {\n    var that = this;\n    this.svg = d3.select(this.root).append(\"svg\");\n    this.legendGroup = this.svg.append(\"g\").attr({class: \"legend-group\"});\n    this.popup = plotd3.html.popup(this.root).on(\"mousemove\", function(d,i,popup) {\n      popup.select(\".title\").text(d.name);\n      popup.select(\".value\").text(parseInt(100 * d.value)/100);\n    });\n  },\n  parse: function() {\n    if(this.dimension.category.fields.length) {\n      this.categories = d3.map(this.data, function(d,i) { return d.category; }).keys();\n    } else {\n      this.categories = [];\n    }\n  },\n  bind: function() {\n    var that = this,sel;\n    this.resize();\n    sel = this.svg.selectAll(\"circle\").data(this.nodes);\n    sel.exit().remove();\n    sel = sel.enter().append(\"circle\").attr({opacity: 1});\n    this.popup.nodes(sel);\n    sel = this.svg.selectAll(\"g.label\").data(this.nodes);\n    sel.exit().remove();\n    sel = sel.enter().append(\"g\").attr({class: \"label\"}).each(function(d,i) {\n      var node = d3.select(this);\n      node.append(\"text\").attr({class: \"name shadow\"});\n      node.append(\"text\").attr({class: \"category shadow\"});\n      node.append(\"text\").attr({class: \"name\"});\n      node.append(\"text\").attr({class: \"category\"});\n    });\n    this.popup.nodes(sel);\n    this.circles = this.svg.selectAll(\"circle\");\n    this.labels = this.svg.selectAll(\"g.label\");\n  },\n  resize: function() {\n    var that = this;\n    var box = this.root.getBoundingClientRect();\n    var width = this.width = box.width;\n    var height = this.height = box.height;\n    this.legendWidth = (d3.max(this.categories.map(function(d) { return ((d || \"\")+\"\").length;})) + 2) * that.config.fontSize;\n    if(isNaN(this.legendWidth)) this.legendWidth = 0;\n    this.svg.attr({\n      width: width + \"px\", height: height + \"px\",\n      viewBox: [0,0,width,height].join(\" \"),\n      preserveAspectRatio: \"xMidYMid\"\n    });\n    this.popup.fontSize(this.config.fontSize);\n    this.cScale = plotdb.Palette.scale.ordinal(this.config.palette);\n    this.legend = plotd3.rwd.legend()\n      .orient(\"right\")\n      .scale(this.cScale)\n      .size([220, this.height - this.config.margin * 2])\n      .tickValues(this.categories)\n      .fontSize(this.config.fontSize);\n    this.legendGroup.call(this.legend).selectAll(\".legend\").on(\"mouseover\",function(d,i) {\n      that.activeGroup = d;\n      that.render();\n    }).on(\"mouseout\",function(d,i) { \n      that.activeGroup = null;\n      that.render();\n    });\n    this.legendSize = this.legend.offset();\n    this.sortby = this.config.sort;\n    this.bubble = d3.layout.pack()\n    .sort(function(a,b) {\n      if(a[that.sortby] < b[that.sortby]) return 1;\n      else if(a[that.sortby] > b[that.sortby]) return -1;\n      return 0;\n    }).padding(this.config.bubblePadding).size([width - (this.config.legendShow ? this.legendWidth : 0),height]);\n    this.nodes = this.bubble.nodes({children: this.data}).filter(function(it) { return it.depth; });\n    for(var i = 0,n,f1,f2; i < this.nodes.length; i++) {\n      n = this.nodes[i];\n      f1 = n.r * 1.8 / (\"\"+(n.name || \"\")).length;\n      f2 = n.r * 1.8 / (\"\"+(n.category || \"\")).length;\n      n.f1 = (f1 > that.config.fontSize * 1.2 ? that.config.fontSize * 1.2 : f1);\n      if(f1 < 14) n.f1 = 14;\n      n.f2 = (f2 > that.config.fontSize * 0.9 ? that.config.fontSize * 0.9 : f2);\n      n.f2 = (n.f1 < n.f2? n.f1: n.f2);\n      if(n.f2 < 12) n.f2 = 12;\n\n    }\n  },\n  render: function() {\n    var that = this,sel;\n    if(this.config.fontFamily) d3.select(this.root).style(\"font-family\", this.config.fontFamily);\n    d3.select(this.root).style(\"background-color\", this.config.background);\n    this.svg.selectAll(\"text\").attr({\n      \"font-size\": that.config.fontSize,\n      \"fill\": that.config.textFill\n    });\n\n    this.legendGroup.attr({\n      transform: [\"translate(\", this.width - this.legendSize[0] - this.config.margin, (this.height - this.legendSize[1])/2, \")\"].join(\" \"),\n      display: (this.config.legendShow ? \"block\" : \"none\")\n    });\n    sel = this.circles;\n    if(this.inited) sel = sel.transition(\"morph\").duration(500);\n    sel.attr({\n      cx: function(it) { return it.x; },\n      cy: function(it) { return it.y; },\n      r:  function(it) { return it.r; }\n    }).style({\n      fill: function(it) { \n        return that.cScale(it.category);\n      },\n      stroke: function(it) {\n        return d3.hsl(that.cScale(it.category)).darker().toString();\n      }\n    });\n    this.circles.transition(\"opacity\").attr({ opacity: function(d) {\n      if(!that.activeGroup || d.category == that.activeGroup) return 1;\n      return 0.1;\n    }});\n    sel = this.labels;\n    if(this.inited) sel = sel.transition(\"morph\").duration(500);\n    sel.attr({\n      transform: function(d,i) { return [\"translate(\",d.x,d.y,\")\"].join(\" \"); },\n    }).each(function(d,i) {\n      var node = d3.select(this);\n      node.selectAll(\"text\").attr({\n        \"text-anchor\": \"middle\",\n        \"dominant-baseline\": \"central\",\n        dy: function() {\n          if(!that.config.catInBubble) return 0;\n          return ( d3.select(this).classed(\"name\") ? -1 : 1 ) * (d.f1 + d.f2) / 4;\n        },\n        \"font-size\": function() {\n          return d3.select(this).classed(\"name\") ? d.f1 : d.f2;\n        },\n        \"font-weight\": function() {\n          return d3.select(this).classed(\"name\") ? \"bold\" : \"light\";\n        },\n        opacity: function() {\n          if(!that.config.labelShow) return 0;\n          if(!that.config.catInBubble && d3.select(this).classed(\"category\")) return 0;\n          return 1;\n        },\n        fill: function() {\n          var hsl = d3.hsl(that.cScale(d.category));\n          if(hsl.l > 0.65) return \"#000\"; else return \"#fff\";\n        },\n        stroke: function(it) {\n          if(!d3.select(this).classed(\"shadow\")) return \"none\";\n          var hsl = d3.hsl(that.cScale(it.category));\n          if(hsl.l > 0.65) return \"#fff\"; else return \"#000\";\n        },\n        \"stroke-width\": function(d,i) {\n          if(!d3.select(this).classed(\"shadow\")) return 2;\n          return that.config.labelShadowSize || 0;\n        },\n      }).text(function() { return d3.select(this).classed(\"name\") ? d.name : d.category; });\n    });\n    this.labels.attr({\n      opacity: function(d,i) {\n        var node = d3.select(this);\n        var wName = node.select(\"text.name\")[0][0].getBBox().width;\n        var wCat = node.select(\"text.category\")[0][0].getBBox().width;\n        if(wName >= d.r * 2.2 || wCat >= d.r * 2.2) return 0;\n        return 1;\n      }\n    });\n    this.inited = true;\n  }\n});\n"},"assets":[],"config":{"fontFamily":{"name":"Font","type":[{"name":"String","default":"","level":2,"basetype":[]}],"default":"Arial","category":"Global Settings","value":"Arial"},"background":{"name":"Background","type":[{"name":"Color","level":10,"default":"#dc4521","Gray":"#cccccc","Positive":"#3f7ab5","Negative":"#d93510","Neutral":"#cccccc","Empty":"#ffffff","subtype":{"negative":"negative","positive":"positive","neutral":"neutral"}}],"default":"#ffffff","category":"Global Settings","value":"#ffffff"},"fontSize":{"name":"Font Size","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":13,"category":"Global Settings","value":"12"},"margin":{"name":"Margin","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":10,"category":"Global Settings","value":10},"bubblePadding":{"name":"Bubble Padding","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":5,"category":"Layout","value":"5"},"palette":{"name":"Palette","type":[{"name":"Palette","level":30,"re":{},"default":{"colors":[{"hex":"#1d3263"},{"hex":"#226c87"},{"hex":"#f8d672"},{"hex":"#e48e11"},{"hex":"#e03215"},{"hex":"#ab2321"}]},"plotdb":{"colors":[{"hex":"#ed1d78"},{"hex":"#c59b6d"},{"hex":"#8cc63f"},{"hex":"#28aae2"}]},"qualitative":{"colors":[{"hex":"#c05ae0"},{"hex":"#cf2d0c"},{"hex":"#e9ab1e"},{"hex":"#86ffb5"},{"hex":"#64dfff"},{"hex":"#003f7d"}]},"binary":{"colors":[{"hex":"#ff8356"},{"hex":"#0076a1"}]},"sequential":{"colors":[{"hex":"#950431"},{"hex":"#be043e"},{"hex":"#ec326d"},{"hex":"#fc82a9"},{"hex":"#febed2"},{"hex":"#fee6ee"}]},"diverging":{"colors":[{"hex":"#74001a"},{"hex":"#cd2149"},{"hex":"#f23971"},{"hex":"#ff84ab"},{"hex":"#ffc3d7"},{"hex":"#f2f2dd"},{"hex":"#b8d9ed"},{"hex":"#81b1d0"},{"hex":"#3d8bb7"},{"hex":"#0071a8"},{"hex":"#003558"}]},"subtype":{"qualitative":"qualitative","binary":"binary","sequential":"sequential","diverging":"diverging"},"scale":{}}],"default":{"colors":[{"hex":"#f4502a"},{"hex":"#f1c227"},{"hex":"#008a6d"},{"hex":"#00acdb"},{"hex":"#0064a8"}]},"category":"Global Settings","value":{"colors":[{"hex":"#f29c98","idx":0},{"hex":"#f5b697","idx":1},{"hex":"#f5e797","idx":2},{"hex":"#a2e4f5","idx":3},{"hex":"#009dd3","idx":4}]}},"legendShow":{"name":"Show Legend","type":[{"name":"Boolean","default":true,"level":8,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"default":true,"category":"Legend","value":true},"labelShadowSize":{"name":"Label Shadow Size","type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"default":2,"category":"Text","value":"1"},"labelShow":{"name":"Show Data Label","type":[{"name":"Boolean","default":true,"level":8,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"default":false,"category":"Label","value":true},"sort":{"type":[{"default":"","name":"Choice","level":20,"values":["value","category","name"]}],"default":"value","rebindOnChange":true,"name":"Sort data","category":"Value","value":"category"},"catInBubble":{"name":"Show Category","type":[{"name":"Boolean","default":true,"level":8,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"default":true,"category":"Special Settings","value":true}},"dimlen":3,"dimension":{"value":{"type":[{"name":"Number","default":0,"level":8,"basetype":[{"name":"Numstring","default":"","level":6,"basetype":[{"name":"Order","level":4,"basetype":[{"name":"String","default":"","level":2,"basetype":[]}],"order":{}}],"order":{}}],"order":{}}],"require":true,"desc":"size of circle","fields":[]},"name":{"type":[],"require":false,"desc":"tag of circle","fields":[]},"category":{"type":[],"require":false,"desc":"category of circle","fields":[]}},"library":["d3/3.5.12/min","plotd3/0.1.0"],"createdtime":"2016-02-19T17:33:10.000Z","modifiedtime":"2016-09-20T08:42:17.000Z","local":null,"ownername":"plotdb","data":[]}]
